<app-nav></app-nav>

<div class="empresa-page">

  <div *ngIf="loading" class="card">Cargando...</div>

  <div *ngIf="!loading && errorMessage" class="card">
    <p class="empty">{{ errorMessage }}</p>
  </div>

  <div *ngIf="!loading && establecimientoOriginal" class="card">

    <div class="panel-header">
      <div>
        <h2>{{ establecimientoOriginal.nombre_establecimiento }}</h2>
        <p class="muted">üìç {{ establecimientoOriginal.ubicacion }}</p>
      </div>

      <div class="actions">
        <button *ngIf="!editMode" (click)="editar()">Editar</button>

        <ng-container *ngIf="editMode">
          <button (click)="guardarCambios()" [disabled]="saving">
            {{ saving ? 'Guardando...' : 'Guardar' }}
          </button>
          <button class="btn-secundario" (click)="cancelar()" [disabled]="saving">
            Cancelar
          </button>
        </ng-container>
      </div>
    </div>

    <div class="contenido">

      <!-- IZQUIERDA -->
      <div class="col-izq">

        <section>
          <h3>Descripci√≥n general</h3>

          <p *ngIf="!editMode">{{ establecimientoOriginal.descripcion || '‚Äî' }}</p>

          <textarea *ngIf="editMode"
            rows="6"
            [(ngModel)]="establecimientoEdit.descripcion"
          ></textarea>
        </section>

        <section>
          <h3>Datos de contacto</h3>

          <p><b>Tel√©fono:</b>
            <span *ngIf="!editMode">{{ establecimientoOriginal.telefono || '‚Äî' }}</span>
            <input *ngIf="editMode" [(ngModel)]="establecimientoEdit.telefono" />
          </p>

          <p><b>Correo:</b>
            <span *ngIf="!editMode">{{ establecimientoOriginal.correo || '‚Äî' }}</span>
            <input *ngIf="editMode" [(ngModel)]="establecimientoEdit.correo" />
          </p>

          <p><b>Estado:</b>
            <span *ngIf="!editMode">{{ establecimientoOriginal.estado || 'activo' }}</span>

            <select *ngIf="editMode" [(ngModel)]="establecimientoEdit.estado">
              <option value="activo">activo</option>
              <option value="inactivo">inactivo</option>
            </select>
          </p>
        </section>

      </div>

      <!-- DERECHA -->
      <div class="col-der">

        <section class="box">
          <h4>Informaci√≥n bloqueada</h4>

          <p><b>Nombre:</b> {{ establecimientoOriginal.nombre_establecimiento }}</p>
          <p><b>Ubicaci√≥n:</b> {{ establecimientoOriginal.ubicacion }}</p>
          <p><b>Direcci√≥n:</b> {{ establecimientoOriginal.direccion || '‚Äî' }}</p>
          <p><b>Tipo:</b> {{ establecimientoOriginal.tipo || '‚Äî' }}</p>
        </section>

        <section class="box">
          <h4>Horarios</h4>

          <!-- Vista -->
          <ng-container *ngIf="!editMode">
            <ul>
              <li *ngFor="let d of diasSemana">
                {{ d }}: {{ establecimientoOriginal.horario_apertura || '‚Äî' }} - {{ establecimientoOriginal.horario_cierre || '‚Äî' }}
              </li>
            </ul>
          </ng-container>

          <!-- Edici√≥n (solo horas, d√≠as fijos) -->
          <ng-container *ngIf="editMode">
            <div class="field">
              <label>Hora apertura</label>
              <input [(ngModel)]="establecimientoEdit.horario_apertura" />
            </div>

            <div class="field">
              <label>Hora cierre</label>
              <input [(ngModel)]="establecimientoEdit.horario_cierre" />
            </div>

            <p class="hint">Los d√≠as se muestran fijos por ahora; solo editas las horas.</p>
          </ng-container>
        </section>

      </div>

    </div>
  </div>

</div>

<app-footer></app-footer>