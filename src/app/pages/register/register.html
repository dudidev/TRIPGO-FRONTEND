<app-nav></app-nav>

@if (successMessage) {
  <div class="toast toast-success" role="status" aria-live="polite">
    {{ successMessage }}
  </div>
}

@if (errorMessage) {
  <div class="toast toast-error" role="alert" aria-live="assertive">
    {{ errorMessage }}
  </div>
}

<div class="ppal" role="main" aria-label="Registro">

  <section class="left">
    <div class="left-content">
      <h1>Registro</h1>

      <div class="logo-circle">
        <img
          src="https://res.cloudinary.com/dtyvd3fim/image/upload/v1764678577/ChatGPT_Image_12_nov_2025_17_33_14_1_hj26hs.png"
          alt="Logo TripGO"
        >
      </div>
    </div>
  </section>

  <aside class="right">
    <div class="carta">
      <h2>Registro</h2>

      <form #registerForm="ngForm" (ngSubmit)="onSubmit(registerForm)" novalidate>

        <div class="field">
          <label for="name">Nombre</label>
          <input
            id="name"
            [(ngModel)]="name"
            name="name"
            type="text"
            required
            minlength="2"
            #nameCtrl="ngModel"
          >

          <small *ngIf="nameCtrl.invalid && (nameCtrl.touched || registerForm.submitted)">
            El nombre es obligatorio (mÃ­nimo 2 caracteres).
          </small>
        </div>

        <div class="field">
          <label for="email">Correo electrÃ³nico</label>
          <input
            id="email"
            [(ngModel)]="email"
            name="email"
            type="email"
            required
            email
            #emailCtrl="ngModel"
          >

          <small *ngIf="emailCtrl.invalid && (emailCtrl.touched || registerForm.submitted)">
            Ingresa un correo vÃ¡lido.
          </small>
        </div>

        <!-- âœ… Password con ojito -->
        <div class="field password-field">
          <label for="password">ContraseÃ±a</label>

          <div class="password-wrap">
            <input
              id="password"
              [(ngModel)]="password"
              name="password"
              [type]="showPassword ? 'text' : 'password'"
              required
              minlength="8"
              pattern="(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}"
              #passwordCtrl="ngModel"
              autocomplete="new-password"
            >

            <button
              type="button"
              class="toggle-pass"
              (click)="togglePassword()"
              [attr.aria-label]="showPassword ? 'Ocultar contraseÃ±a' : 'Mostrar contraseÃ±a'"
            >
              {{ showPassword ? 'ğŸ•¶ï¸' : 'ğŸ‘ï¸' }}
            </button>
          </div>

          <small *ngIf="passwordCtrl.invalid && (passwordCtrl.touched || registerForm.submitted)">
            Debe tener mÃ­nimo 8 caracteres e incluir letras y nÃºmeros.
          </small>
        </div>

        <!-- âœ… Confirmar contraseÃ±a con ojito -->
        <div class="field password-field">
          <label for="confirmPassword">Confirmar contraseÃ±a</label>

          <div class="password-wrap">
            <input
              id="confirmPassword"
              [(ngModel)]="confirmPassword"
              name="confirmPassword"
              [type]="showConfirmPassword ? 'text' : 'password'"
              required
              minlength="8"
              autocomplete="new-password"
              #confirmPasswordCtrl="ngModel"
            >

            <button
              type="button"
              class="toggle-pass"
              (click)="toggleConfirmPassword()"
              [attr.aria-label]="showConfirmPassword ? 'Ocultar contraseÃ±a' : 'Mostrar contraseÃ±a'"
            >
              {{ showConfirmPassword ? 'ğŸ•¶ï¸' : 'ğŸ‘ï¸' }}
            </button>
          </div>

          <small *ngIf="confirmPasswordCtrl.invalid && (confirmPasswordCtrl.touched || registerForm.submitted)">
            Confirma tu contraseÃ±a.
          </small>

          <!-- âœ… Mensaje especÃ­fico cuando no coinciden (solo cuando ambos tienen algo) -->
          <small
            class="mismatch"
            *ngIf="
              (passwordCtrl.touched || confirmPasswordCtrl.touched || registerForm.submitted) &&
              password &&
              confirmPassword &&
              password !== confirmPassword
            "
          >
            Las contraseÃ±as no coinciden.
          </small>
        </div>

        <button class="btn btn-primary" type="submit" [disabled]="registerForm.invalid">
          Registrar
        </button>

        <p class="account">
          Ya tienes una cuenta?
          <a routerLink="/login">Iniciar sesiÃ³n</a>
        </p>

      </form>
    </div>
  </aside>
</div>

<app-footer></app-footer>