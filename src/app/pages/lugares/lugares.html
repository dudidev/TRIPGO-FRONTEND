<app-nav></app-nav>

<section class="results">

  <!-- ================= HERO ================= -->
  <header class="results__hero">

    <!-- Carrusel -->
    <div class="results__heroCarousel">

      <!-- Si hay imágenes -->
      <ng-container *ngIf="heroImgs?.length; else heroFallback">
        <img
          *ngFor="let img of heroImgs; let i = index"
          class="results__heroImg"
          [class.active]="i === heroIndex"
          [src]="img"
          alt="Hero"
        />
      </ng-container>

      <!-- Fallback si no hay imágenes -->
      <ng-template #heroFallback>
        <img
          class="results__heroImg active"
          [src]="'https://via.placeholder.com/1400x500?text=' + (titulo | uppercase)"
          alt="Hero"
        />
      </ng-template>

    </div>

    <!-- Overlay -->
    <div class="results__heroOverlay">
      <h1 class="results__title">
        {{ titulo | uppercase }}
      </h1>

      <p class="results__subtitle">
        {{ townSlug | titlecase }} • Quindío
      </p>
    </div>

  </header>


  <!-- ================= PANEL ================= -->
  <div class="results__panel">

    <!-- ================= MAIN ================= -->
    <main class="results__main">

      <!-- BUSCADOR -->
      <form class="results__search" (ngSubmit)="onSearch()">
        <div class="searchPill">
          <input
            type="text"
            name="q"
            [(ngModel)]="query"
            placeholder="Encuentra el mejor lugar"
            autocomplete="off"
            [disabled]="loading"
          />
          <button type="submit" [disabled]="loading">
            Buscar
          </button>
        </div>
      </form>


      <!-- ================= ESTADOS ================= -->

      <!-- Loading -->
      <div *ngIf="loading" class="results__state">
        Cargando establecimientos...
      </div>

      <!-- Error o vacío -->
      <div *ngIf="!loading && errorMsg" class="results__state">
        {{ errorMsg }}
      </div>


      <!-- ================= GRID ================= -->
      <section class="cards" *ngIf="!loading && !errorMsg">

        <button
          class="card"
          type="button"
          *ngFor="let item of filtered"
          (click)="openItem(item)"
        >
          <img
            [src]="item.img"
            [alt]="item.titulo"
          />
          <div class="card__label">
            {{ item.titulo }}
          </div>
        </button>

      </section>

    </main>


    <!-- ================= SIDEBAR ================= -->
    <aside class="results__side">

      <div class="sideCard">
        <h3>Sugerencias itinerario</h3>
        <p class="sideSub">selecciona la opción que desees</p>

        <div class="itinerary">
          <button class="itineraryItem" type="button">
            1. Plan clásico
          </button>
          <button class="itineraryItem" type="button">
            2. Plan aventura
          </button>
          <button class="itineraryItem" type="button">
            3. Plan gastronómico
          </button>
          <button class="itineraryItem" type="button">
            4. Plan romántico
          </button>
        </div>

      </div>

    </aside>

  </div>

</section>

<app-footer></app-footer>